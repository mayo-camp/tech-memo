\usepackage{tcolorbox}
\tcbuselibrary{listingsutf8}
\tcbuselibrary{breakable} % 長いコードをページ跨ぎで分割可能

\usepackage{xcolor}
\usepackage{needspace}
\usepackage{fvextra}      % verbatim 改行サポート
\usepackage{geometry}
\geometry{b5paper, top=12.7mm, bottom=12.7mm, left=12.7mm, right=12.7mm}
\raggedbottom

% コードブロック
\newtcolorbox{codeblock}{
  breakable,              % ページ跨ぎで分割可能
  enhanced,
  colback=gray!15,
  colframe=gray!50,
  boxrule=0.5pt,
  arc=1.5mm,
  left=4pt, right=4pt, top=4pt, bottom=4pt,
  listing only,
  listing options={
    basicstyle=\ttfamily\footnotesize,
    breaklines=true,
    breakatwhitespace=true,
    columns=flexible,     % 長い行の折り返し改善
  }
}

% インラインコード
\newcommand{\inlinecode}[1]{%
  \colorbox{gray!15}{\ttfamily #1}%
}

% 見出し前に最低限確保する行数
\newcommand{\sectionbreak}{\Needspace{3\baselineskip}}
